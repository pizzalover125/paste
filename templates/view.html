{% extends 'base.html' %} {% block title %}{{ paste['title'] }}{% endblock %} {%
block content %}
<style>
  .paste {
    max-height: 400px;
    overflow: auto;
    padding: 1rem;
    border: 1px solid #e1e1e1;
    background: #fff;
    white-space: pre-wrap;
    -webkit-overflow-scrolling: touch;
  }
  .copy-btn {
    display: inline-block;
    padding: 0.5rem 1rem;
    background: #000000;
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    font-size: 0.9rem;
    margin-left: 0.5rem;
  }
  .copy-btn:hover {
    background: #333333;
  }
  .copy-btn:active {
    background: #555555;
  }
  .copy-success {
    background: #28a745 !important;
  }
  .stats {
    color: #666;
    font-size: 0.9rem;
    margin-top: 0.5rem;
    margin-bottom: 1rem;
    padding: 0.5rem;
    background: #f5f5f5;
    border-left: 3px solid #000;
  }
</style>

<h2>{{ paste['title'] }}</h2>
<div class="paste" id="pasteContent">{{ paste['content'] }}</div>
<div class="stats" id="stats"></div>
<p>
  Share:
  <a href="{{ request.url }}" style="text-decoration: underline" id="pasteUrl"
    >{{ request.url }}</a
  >
</p>
<p>
  Share Raw:
  <a
    href="{{ request.url }}/raw"
    style="text-decoration: underline"
    id="pasteRawUrl"
    >{{ request.url }}/raw</a
  >
</p>
<button class="copy-btn" onclick="copyLink()" id="copyLinkBtn">
  Copy Link
</button>
<button class="copy-btn" onclick="copyRawLink()" id="copyRawLinkBtn">
  Copy Raw Link
</button>
<button class="copy-btn" onclick="copyContent()" id="copyContentBtn">
  Copy Content
</button>

<script>
  function updateStats() {
    const content = document.getElementById("pasteContent").textContent;
    const charCount = content.length;
    const wordCount = content
      .trim()
      .split(/\s+/)
      .filter((word) => word.length > 0).length;
    const lineCount = content.split("\n").length;

    document.getElementById(
      "stats"
    ).textContent = `${charCount.toLocaleString()} characters • ${wordCount.toLocaleString()} words • ${lineCount.toLocaleString()} lines`;
  }

  updateStats();

  function copyContent() {
    const content = document.getElementById("pasteContent").textContent;
    navigator.clipboard
      .writeText(content)
      .then(() => {
        const btn = document.getElementById("copyContentBtn");
        const originalText = btn.textContent;
        btn.textContent = "Copied!";
        btn.classList.add("copy-success");
        setTimeout(() => {
          btn.textContent = originalText;
          btn.classList.remove("copy-success");
        }, 2000);
      })
      .catch((err) => {
        console.error("Failed to copy:", err);
        alert("Failed to copy to clipboard");
      });
  }

  function copyLink() {
    const url = document.getElementById("pasteUrl").textContent;
    navigator.clipboard
      .writeText(url)
      .then(() => {
        const btn = document.getElementById("copyLinkBtn");
        const originalText = btn.textContent;
        btn.textContent = "Copied!";
        btn.classList.add("copy-success");
        setTimeout(() => {
          btn.textContent = originalText;
          btn.classList.remove("copy-success");
        }, 2000);
      })
      .catch((err) => {
        console.error("Failed to copy:", err);
        alert("Failed to copy to clipboard");
      });
  }

  function copyRawLink() {
    const url = document.getElementById("pasteRawUrl").textContent;
    navigator.clipboard
      .writeText(url)
      .then(() => {
        const btn = document.getElementById("copyRawLinkBtn");
        const originalText = btn.textContent;
        btn.textContent = "Copied!";
        btn.classList.add("copy-success");
        setTimeout(() => {
          btn.textContent = originalText;
          btn.classList.remove("copy-success");
        }, 2000);
      })
      .catch((err) => {
        console.error("Failed to copy:", err);
        alert("Failed to copy to clipboard");
      });
  }
</script>
{% endblock %}
